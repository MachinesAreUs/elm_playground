<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>koch2</title><script type="text/javascript" src="/elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm)
                {
                  _elm.Main = _elm.Main || {};
                  if (_elm.Main.values)
                  return _elm.Main.values;
                  var _N = Elm.Native,
                      _U = _N.Utils.make(_elm),
                      _L = _N.List.make(_elm),
                      _E = _N.Error.make(_elm),
                      _J = _N.JavaScript.make(_elm),
                      $moduleName = "Main";
                  var Basics = Elm.Basics.make(_elm);
                  var Color = Elm.Color.make(_elm);
                  var Graphics = Graphics || {};
                  Graphics.Collage = Elm.Graphics.Collage.make(_elm);
                  var Graphics = Graphics || {};
                  Graphics.Element = Elm.Graphics.Element.make(_elm);
                  var List = Elm.List.make(_elm);
                  var Maybe = Elm.Maybe.make(_elm);
                  var Native = Native || {};
                  Native.Ports = Elm.Native.Ports.make(_elm);
                  var Prelude = Elm.Prelude.make(_elm);
                  var Signal = Elm.Signal.make(_elm);
                  var String = Elm.String.make(_elm);
                  var Text = Elm.Text.make(_elm);
                  var Time = Elm.Time.make(_elm);
                  var Window = Elm.Window.make(_elm);
                  var _op = {};
                  var trisect = F2(function (_v0,_v1)
                                   {
                                     return function ()
                                            {
                                              switch (_v1.ctor)
                                              {case
                                               "_Tuple2" :
                                                 return function ()
                                                        {
                                                          switch (_v0.ctor)
                                                          {case
                                                           "_Tuple2" :
                                                             return function ()
                                                                    {
                                                                      var $ = {ctor: "_Tuple2", _0: (_v1._0 - _v0._0) / 3, _1: (_v1._1 - _v0._1) / 3},
                                                                          dx = $._0,
                                                                          dy = $._1;
                                                                      return {ctor: "_Tuple2", _0: {ctor: "_Tuple2", _0: _v0._0 + dx, _1: _v0._1 + dy}, _1: {ctor: "_Tuple2", _0: _v0._0 + 2 * dx, _1: _v0._1 + 2 * dy}};
                                                                    }();}
                                                          _E.Case($moduleName,
                                                                  "between lines 9 and 10");
                                                        }();}
                                              _E.Case($moduleName,"between lines 9 and 10");
                                            }();
                                   });
                  var distance = F2(function (_v8,_v9)
                                    {
                                      return function ()
                                             {
                                               switch (_v9.ctor)
                                               {case
                                                "_Tuple2" :
                                                  return function ()
                                                         {
                                                           switch (_v8.ctor)
                                                           {case
                                                            "_Tuple2" :
                                                              return Basics.sqrt(Math.pow(_v9._0 - _v8._0,
                                                                                          2) + Math.pow(_v9._1 - _v8._1,
                                                                                                        2));}
                                                           _E.Case($moduleName,
                                                                   "on line 6, column 26 to 61");
                                                         }();}
                                               _E.Case($moduleName,"on line 6, column 26 to 61");
                                             }();
                                    });
                  var complete = F2(function (_v16,_v17)
                                    {
                                      return function ()
                                             {
                                               switch (_v17.ctor)
                                               {case
                                                "_Tuple2" :
                                                  return function ()
                                                         {
                                                           switch (_v16.ctor)
                                                           {case
                                                            "_Tuple2" :
                                                              return function ()
                                                                     {
                                                                       var theta = Basics.pi / 3 + A2(Basics.atan2,
                                                                                                      _v17._1 - _v16._1,
                                                                                                      _v17._0 - _v16._0);
                                                                       var side = A2(distance,
                                                                                     {ctor: "_Tuple2", _0: _v16._0, _1: _v16._1},
                                                                                     {ctor: "_Tuple2", _0: _v17._0, _1: _v17._1});
                                                                       var $ = {ctor: "_Tuple2", _0: side * Basics.cos(theta), _1: side * Basics.sin(theta)},
                                                                           a2 = $._0,
                                                                           b2 = $._1;
                                                                       return {ctor: "_Tuple2", _0: _v16._0 + a2, _1: _v16._1 + b2};
                                                                     }();}
                                                           _E.Case($moduleName,
                                                                   "between lines 13 and 16");
                                                         }();}
                                               _E.Case($moduleName,"between lines 13 and 16");
                                             }();
                                    });
                  var koch_set = F3(function (n,idx,_v24)
                                    {
                                      return function ()
                                             {
                                               switch (_v24.ctor)
                                               {case
                                                "::" :
                                                  switch (_v24._1.ctor)
                                                  {case
                                                   "::" :
                                                     switch (_v24._1._1.ctor)
                                                     {case
                                                      "[]" :
                                                        return function ()
                                                               {
                                                                 var $ = A2(trisect,
                                                                            _v24._0,
                                                                            _v24._1._0),
                                                                     p2 = $._0,
                                                                     p4 = $._1;
                                                                 var p3 = A2(complete,p2,p4);
                                                                 return _U.cmp(idx,
                                                                               n) < 0 ? List.concat(List.map(A2(koch_set,
                                                                                                                n,
                                                                                                                idx + 1))(_J.toList([_J.toList([_v24._0,
                                                                                                                                                p2]),
                                                                                                                                     _J.toList([p2,
                                                                                                                                                p3]),
                                                                                                                                     _J.toList([p3,
                                                                                                                                                p4]),
                                                                                                                                     _J.toList([p4,
                                                                                                                                                _v24._1._0])]))) : _J.toList([_J.toList([_v24._0,
                                                                                                                                                                                         _v24._1._0])]);
                                                               }();}
                                                     break;}
                                                  break;}
                                               _E.Case($moduleName,"between lines 19 and 23");
                                             }();
                                    });
                  var koch = F2(function (_v30,t)
                                {
                                  return function ()
                                         {
                                           switch (_v30.ctor)
                                           {case
                                            "_Tuple2" :
                                              return function ()
                                                     {
                                                       var unify = List.map(List.head);
                                                       var side = 0.8 * A2(Basics.min,
                                                                           Basics.toFloat(_v30._0),
                                                                           Basics.toFloat(_v30._1));
                                                       var $ = {ctor: "_Tuple2", _0: side / 2, _1: Basics.tan(Basics.pi / 6) * side / 2},
                                                           dx = $._0,
                                                           dy = $._1;
                                                       var p1 = {ctor: "_Tuple2", _0: 0 - dx, _1: 0 - dy};
                                                       var p3 = {ctor: "_Tuple2", _0: dx, _1: 0 - dy};
                                                       var p2 = {ctor: "_Tuple2", _0: side * Basics.cos(Basics.pi / 3) - dx, _1: side * Basics.sin(Basics.pi / 3) - dy};
                                                       var initialSet = _J.toList([_J.toList([p1,
                                                                                              p2]),
                                                                                   _J.toList([p2,
                                                                                              p3]),
                                                                                   _J.toList([p3,
                                                                                              p1])]);
                                                       var style = Graphics.Collage.traced(Graphics.Collage.solid(A3(Color.hsv,
                                                                                                                     t * Basics.pi / 2000,
                                                                                                                     0.9,
                                                                                                                     0.9)));
                                                       var iterations = 6;
                                                       return Graphics.Element.color(Color.black)(A3(Graphics.Collage.collage,
                                                                                                     _v30._0,
                                                                                                     _v30._1,
                                                                                                     _J.toList([style(unify(List.concat(List.map(A2(koch_set,
                                                                                                                                                    6,
                                                                                                                                                    0))(initialSet))))])));
                                                     }();}
                                           _E.Case($moduleName,"between lines 26 and 39");
                                         }();
                                });
                  var main = A2(Signal._op["~"],
                                A2(Signal._op["<~"],koch,Window.dimensions),
                                A3(Signal.foldp,
                                   F2(function (x,y)
                                      {
                                        return x + y;
                                      }),
                                   0,
                                   Time.fps(3)));
                  var middle = F2(function (_v34,_v35)
                                  {
                                    return function ()
                                           {
                                             switch (_v35.ctor)
                                             {case
                                              "_Tuple2" :
                                                return function ()
                                                       {
                                                         switch (_v34.ctor)
                                                         {case
                                                          "_Tuple2" :
                                                            return {ctor: "_Tuple2", _0: (_v34._0 + _v35._0) / 2, _1: (_v34._1 + _v35._1) / 2};}
                                                         _E.Case($moduleName,
                                                                 "on line 4, column 25 to 51");
                                                       }();}
                                             _E.Case($moduleName,"on line 4, column 25 to 51");
                                           }();
                                  });
                  _elm.Main.values = {_op: _op, middle: middle, distance: distance, trisect: trisect, complete: complete, koch_set: koch_set, koch: koch, main: main};
                  return _elm.Main.values;
                };</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>